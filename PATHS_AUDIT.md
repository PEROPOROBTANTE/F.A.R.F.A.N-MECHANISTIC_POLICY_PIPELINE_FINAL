# Path Audit Report

**Generated by:** `scripts/audit_paths.py`
**Repository:** /home/runner/work/SAAAAAA/SAAAAAA

## Executive Summary

- **Files Scanned:** 321
- **Total Findings:** 174
- **Critical:** 0
- **High:** 18
- **Medium:** 155
- **Low:** 1

## Findings by Severity

### HIGH (18)

#### absolute_path (18 occurrences)

- **tests/test_enhanced_recommendations.py:148**
  - Absolute Unix path detected
  - Code: `output_json = "/tmp/test_recommendations.json"`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/test_enhanced_recommendations.py:149**
  - Absolute Unix path detected
  - Code: `output_md = "/tmp/test_recommendations.md"`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/test_integration_failures.py:186**
  - Absolute Unix path detected
  - Code: `file_path="/tmp/sample.pdf",`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_workspace_bounds.py:96**
  - Absolute Unix path detected
  - Code: `outside = Path("/tmp/outside")`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_workspace_bounds.py:103**
  - Absolute Unix path detected
  - Code: `outside = Path("/tmp/malicious.txt")`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_no_absolutes.py:55**
  - Absolute Unix path detected
  - Code: `if 'native_check.py' in str(py_file) and ('/usr/lib' in line or '/usr/local/lib' in line):`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_no_absolutes.py:61**
  - Absolute Unix path detected
  - Code: `if 'test_' in str(py_file) and '/tmp/' in line:`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_utils.py:127**
  - Absolute Unix path detected
  - Code: `outside = Path("/tmp/other")`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_utils.py:166**
  - Absolute Unix path detected
  - Code: `result = safe_join(base, "/tmp/other")`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

- **tests/paths/test_paths_utils.py:233**
  - Absolute Unix path detected
  - Code: `outside = Path("/tmp/outside_workspace.txt")`
  - Fix: Use proj_root() or data_dir() from saaaaaa.utils.paths

  ... and 8 more occurrences

### MEDIUM (155)

#### cwd_usage (3 occurrences)

- **scripts/audit_paths.py:215**
  - Current working directory usage - fragile in different execution contexts
  - Code: `# os.getcwd() or Path.cwd()`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

- **src/saaaaaa/core/orchestrator/core.py:1179**
  - Current working directory usage - fragile in different execution contexts
  - Code: `candidates.append(os.path.join(os.getcwd(), path))`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

- **src/saaaaaa/core/orchestrator/core.py:1181**
  - Current working directory usage - fragile in different execution contexts
  - Code: `candidates.append(os.path.join(os.getcwd(), "rules", "METODOS", path))`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

#### file_usage (49 occurrences)

- **setup.py:22**
  - __file__ usage detected - may break in packaged distributions
  - Code: `readme_file = Path(__file__).parent / "README.md"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **setup.py:29**
  - __file__ usage detected - may break in packaged distributions
  - Code: `requirements_file = Path(__file__).parent / "requirements.txt"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **runtime_audit.py:662**
  - __file__ usage detected - may break in packaged distributions
  - Code: `repo_root = Path(__file__).parent.resolve()`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **validate_strategic_wiring.py:18**
  - __file__ usage detected - may break in packaged distributions
  - Code: `root = Path(__file__).parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **examples/flux_demo.py:20**
  - __file__ usage detected - may break in packaged distributions
  - Code: `sys.path.insert(0, str(Path(__file__).parent.parent / "src"))`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **examples/flux_demo.py:206**
  - __file__ usage detected - may break in packaged distributions
  - Code: `source_paths=[Path(__file__).parent.parent / "src" / "saaaaaa" / "flux"],`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **concurrency/concurrency.py:7**
  - __file__ usage detected - may break in packaged distributions
  - Code: `_SRC_PATH = Path(__file__).resolve().parent.parent / "src"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **concurrency/__init__.py:14**
  - __file__ usage detected - may break in packaged distributions
  - Code: `_SRC_PATH = Path(__file__).resolve().parent.parent / "src"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **executors/__init__.py:14**
  - __file__ usage detected - may break in packaged distributions
  - Code: `_SRC_PATH = Path(__file__).resolve().parent.parent / "src"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **scoring/__init__.py:7**
  - __file__ usage detected - may break in packaged distributions
  - Code: `_SRC_PATH = Path(__file__).resolve().parent.parent / "src"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

  ... and 39 more occurrences

#### hardcoded_separator (98 occurrences)

- **setup.py:46**
  - Potential hardcoded path separator detected
  - Code: `url="https://github.com/kkkkknhh/SAAAAAA",`
  - Fix: Use Path.joinpath() or / operator

- **setup.py:48**
  - Potential hardcoded path separator detected
  - Code: `"Bug Tracker": "https://github.com/kkkkknhh/SAAAAAA/issues",`
  - Fix: Use Path.joinpath() or / operator

- **setup.py:49**
  - Potential hardcoded path separator detected
  - Code: `"Documentation": "https://github.com/kkkkknhh/SAAAAAA#readme",`
  - Fix: Use Path.joinpath() or / operator

- **setup.py:50**
  - Potential hardcoded path separator detected
  - Code: `"Source Code": "https://github.com/kkkkknhh/SAAAAAA",`
  - Fix: Use Path.joinpath() or / operator

- **examples/concurrency_integration_demo.py:129**
  - Potential hardcoded path separator detected
  - Code: `base_slot = f"D{base_idx//5+1}-Q{base_idx%5+1}"`
  - Fix: Use Path.joinpath() or / operator

- **examples/flux_demo.py:67**
  - Potential hardcoded path separator detected
  - Code: `input_uri = "demo://sample-policy-document.pdf"`
  - Fix: Use Path.joinpath() or / operator

- **scripts/audit_paths.py:78**
  - Potential hardcoded path separator detected
  - Code: `"absolute_windows": re.compile(r'["\'][A-Z]:\\\\[^"\']*["\']'),`
  - Fix: Use Path.joinpath() or / operator

- **scripts/audit_paths.py:87**
  - Potential hardcoded path separator detected
  - Code: `"hardcoded_separator": re.compile(r'["\'][^"\']*[/\\]{2,}[^"\']*["\']'),`
  - Fix: Use Path.joinpath() or / operator

- **scripts/audit_paths.py:90**
  - Potential hardcoded path separator detected
  - Code: `"temp_hardcode": re.compile(r'["\'](?:/tmp|C:\\\\temp)["\']'),`
  - Fix: Use Path.joinpath() or / operator

- **scripts/equip_signals.py:14**
  - Potential hardcoded path separator detected
  - Code: `"""Warm up memory:// signal cache with test data."""`
  - Fix: Use Path.joinpath() or / operator

  ... and 88 more occurrences

#### os_path_usage (5 occurrences)

- **src/saaaaaa/compat/native_check.py:118**
  - os.path usage detected
  - Code: `dll_path = os.path.join(path_dir, f"{libname}.dll")`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1177**
  - os.path usage detected
  - Code: `base_dir = os.path.dirname(__file__)`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1178**
  - os.path usage detected
  - Code: `candidates.append(os.path.join(base_dir, path))`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1179**
  - os.path usage detected
  - Code: `candidates.append(os.path.join(os.getcwd(), path))`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1181**
  - os.path usage detected
  - Code: `candidates.append(os.path.join(os.getcwd(), "rules", "METODOS", path))`
  - Fix: Use pathlib.Path instead of os.path

### LOW (1)

#### open_without_context (1 occurrences)

- **tools/testing/generate_synthetic_traffic.py:247**
  - open() call - verify proper resource cleanup
  - Code: `open(args.output, 'w').close()`
  - Fix: Consider using 'with open(...)' for automatic cleanup

## Findings by Category

### hardcoded_separator: 98 occurrences

### file_usage: 49 occurrences

### absolute_path: 18 occurrences

### os_path_usage: 5 occurrences

### cwd_usage: 3 occurrences

### open_without_context: 1 occurrences


## Recommendations

1. **Eliminate sys.path manipulation**: Use proper package imports
2. **Remove absolute paths**: Use `proj_root()`, `data_dir()`, etc. from `saaaaaa.utils.paths`
3. **Replace os.path with pathlib.Path**: More portable and Pythonic
4. **Use resources() for packaged data**: Ensures compatibility with wheels/sdist
5. **Validate all path operations**: Use `validate_read_path()` and `validate_write_path()`
6. **Add path traversal protection**: Use `safe_join()` for user-provided paths
7. **Use temp_dir() instead of hardcoded /tmp**: Ensures controlled cleanup

## Next Steps

1. Create tests under `tests/paths/` to enforce these rules
2. Fix critical and high severity issues first
3. Add pre-commit hooks to prevent regressions
4. Update CI to test on Windows, macOS, and Linux
5. Document path handling guidelines in README
